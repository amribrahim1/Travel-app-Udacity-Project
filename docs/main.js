var Client=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));const r=void places({appId:e.env.algolia_ID,apiKey:e.env.algolia_API_KEY,container:document.querySelector("#city"),templates:{suggestion:function(e){return'<i class="flag '+e.countryCode+'"></i> '+e.name+", "+e.country},value:function(e){return e.name+" "+e.countryCode}}}).configure({type:"city",aroundLatLngViaIP:!1})}).call(this,n(1))},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,s=[],d=!1,u=-1;function m(){d&&c&&(d=!1,c.length?s=c.concat(s):u=-1,s.length&&p())}function p(){if(!d){var e=l(m);d=!0;for(var t=s.length;t;){for(c=s,s=[];++u<t;)c&&c[u].run();u=-1,t=s.length}c=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new g(e,t)),1!==s.length||d||l(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t);var r=n(0);const i=async(e,t,n,r)=>{const i=await fetch(e+"?lat="+t+"&lon="+n+"&key="+r);try{return await i.json()}catch(e){return console.log("error",e),!1}},a=async(e,t,n)=>{const r=await fetch(e+"&key="+t+"&q="+n);try{return await r.json()}catch(e){return console.log("error",e),!1}},o=async(e,t,n)=>{const r=await fetch(e+"?lat="+t+"&lng="+n);try{return await r.json()}catch(e){return console.log("error",e),!1}};let l="";function c(){document.getElementById("trips").innerHTML="",JSON.parse(localStorage.getItem("trips"))&&null!==JSON.parse(localStorage.getItem("trips"))&&0!==JSON.parse(localStorage.getItem("trips")).length&&(document.getElementById("clear").style.display="block",JSON.parse(localStorage.getItem("trips")).forEach((e=>{let t=e.chosenHotel?e.chosenHotel.bookingURL:"#",n=e.chosenHotel?e.chosenHotel.name:"",r=e.image?`<img class="" src="${e.image}" alt="${e.city.name}"/>`:"",i=`\n            <div class="card-destination">\n                <button class="delete close" onclick="Client.remove(this)" value="${e.id}" title="delete trip" data-toggle="tooltip" data-placement="left" aria-hidden="true">×</button>    \n                <div class="destination-image">\n                    ${r}\n                </div>\n                <div class="country-flag">\n                    <span class="flag-icon flag-icon-${e.city.countryCode.toLowerCase()} flag-icon-squared country-flag-size-2x country-flag-circle"></span>\n                </div>\n                <div class="destination-info">\n                    <div class="place-name">\n                        <h2>${e.city.name} <small>${e.city.countryName}</small></h2>\n                    </div>\n                    <div class="place-desc">\n                        <div class="current">\n                            <h6>Current<br>Weather</h6>\n                            <div>\n                                <p id="temp">${e.currentWeather.temp} °C</p>\n                                <p id="weather-description">${e.currentWeather.weather.description}</p>\n                            </div>\n                            <div>\n                                <img id="weather-icon" src="https://www.weatherbit.io/static/img/icons/${e.currentWeather.weather.icon}.png" width="70px"/>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="below-line"></div>\n                    <div class="destination-hastag">\n                        <div class="col-auto">\n                            <div class="input-group mb-2">\n                                <div class="input-group-prepend">\n                                    <div class="input-group-text">from</div>\n                                </div>\n                                <p class="form-control" id="travelDate">${e.departure}</p>\n                                <div class="input-group-prepend">\n                                    <div class="input-group-text">to</div>\n                                </div>\n                                <p class="form-control" id="travelDate">${e.return}</p>\n                            </div>\n                        </div>\n                        <div class="col-auto">\n                            <div class="input-group mb-2">\n                                <div class="input-group-prepend">\n                                    <div class="input-group-text">Hotel</div>\n                                </div>\n                                <a class="form-control" id="travelDate" href="${t}">${n}</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;l+=i})),$("#trips").html(l))}let s={city:[],currentWeather:[],forecastWeather:[],images:[],hotels:[]};const d=e=>{e.preventDefault(),document.getElementById("modalBody").style.display="none",document.getElementById("trip").innerHTML="",document.getElementById("departure").innerHTML="",document.getElementById("return").innerHTML="",document.getElementById("temp").innerHTML="",document.getElementById("weather-description").innerHTML="",document.getElementById("weather-icon").innerHTML="",document.getElementById("images").innerHTML="",document.getElementById("forecastWeather").innerHTML="",document.getElementById("hotelDetails").innerHTML="",document.getElementById("hotelSelect").innerHTML="<option value='none'>select a hotel</option>",document.getElementById("ModalLabel").innerHTML='\n        <div class="text-center m-auto">\n            <div class="spinner-border" role="status">\n                <span class="sr-only">Loading...</span>\n            </div>\n        </div>',$("#cityModal").modal("show");const t=$("#travelDate").val(),n=$("#endDate").val(),r="882309dfe0184f45a84999697ace4437",l=$("#city").val(),c=new Date;let d,u;const p=(e,t)=>{const n=new Date(Number(e));return n.setDate(e.getDate()+t),n};console.log("Is travl date in the next 16 days? ",new Date(t)<p(c,16)),(async(e,t,n)=>{const r=await fetch(e+"&q="+t+"&username="+n);try{return await r.json()}catch(e){return console.log("error",e),!1}})("http://api.geonames.org/searchJSON?maxRows=1",l,"amribrahim1").then((e=>{const l=e.geonames[0].lat,m=e.geonames[0].lng,g=e.geonames[0].name;s.city=e.geonames[0],Promise.all([i("https://api.weatherbit.io/v2.0/current",l,m,r),i("https://api.weatherbit.io/v2.0/forecast/daily",l,m,r),a("https://pixabay.com/api/?category=travel&category=travel&per_page=5","19131721-a15a95f04b715222051a2de96",g),o("https://www.geonames.org/findNearbyHotelsJSON",l,m)]).then((([e,r,i,a])=>{s.currentWeather=e.data[0],s.images=i.hits,s.hotels=a.hotels,new Date(t)<p(c,16)&&(d=r.data.findIndex((e=>e.datetime===t)),u=new Date(n)<p(c,16)?r.data.findIndex((e=>e.datetime===n)):d+4,s.forecastWeather=r.data.filter(((e,t)=>t<=u&&t>=d))),console.log(s)}))})).then((e=>{setTimeout((()=>{m(s,t,n)}),3e3)})),document.getElementById("form").reset()},u=()=>{const e=document.getElementById("hotelSelect").value,t=s.hotels.find((t=>t.hotelName===e));document.getElementById("hotelDetails").innerHTML="","none"!==e&&(document.getElementById("hotelDetails").innerHTML=`\n                <div class="input-group mb-2">\n                    <div class="input-group-prepend">\n                        <div class="input-group-text">Name</div>\n                    </div>\n                    <a class="form-control" id="hotelName" title="Booking URL" href="${t.bookingURLs[0].bookingURL}">${t.hotelName}</a>\n                </div>\n                <div class="input-group mb-2">\n                    <div class="input-group-prepend">\n                        <div class="input-group-text">Address</div>\n                    </div>\n                    <p class="form-control" id="hotelAddress">${t.address}</p>\n                </div>\n                <div class="input-group mb-2">\n                    <div class="input-group-prepend">\n                        <div class="input-group-text">Distance</div>\n                    </div>\n                    <p class="form-control" id="hotelDistance">${t.distance.toFixed(2)} KM</p>\n                </div>\n            `)},m=async(e,t,n)=>{if($("#departure").html(t),$("#return").html(n),document.getElementById("ModalLabel").innerHTML=`<img src="https://www.countryflags.io/${e.city.countryCode}/flat/64.png">  ${e.city.toponymName}, ${e.city.countryName}`,$("#trip").html(`Trip to: ${e.city.toponymName}, ${e.city.countryName}`),$("#temp").html(e.currentWeather.temp+" °C"),$("#weather-description").html(""+e.currentWeather.weather.description),$("#weather-icon").attr("src",`https://www.weatherbit.io/static/img/icons/${e.currentWeather.weather.icon}.png`),0!==e.images.length){var r,i="";for($("#imagesCol").addClass("col-xl"),$("#weatherCol").removeClass("width-100"),r=1;r<e.images.length;r++)i+=`\n                <div class="carousel-item">\n                    <img src="${e.images[r].webformatURL}" class="d-block w-100" alt="${e.city.name}">\n                </div>`;const t=`\n            <div class="carousel-item active">\n                <img src="${e.images[0].webformatURL}" alt="${e.city.name}">                                       \n            </div>\n        `;document.getElementById("images").innerHTML=i+t}else document.getElementById("images").innerHTML="",$("#imagesCol").removeClass("col-xl"),$("#weatherCol").addClass("width-100");if(0!==e.forecastWeather.length)for(const t of e.forecastWeather)document.getElementById("forecastWeather").innerHTML+=`\n            <div>\n                <img src="https://www.weatherbit.io/static/img/icons/${t.weather.icon}.png" alt="weather icon">\n                <h5 class="text-center">${t.weather.description}</h5>\n                <h3 class="text-center">${t.temp}°C</h3>\n                <p class="text-center">${t.max_temp}°/${t.min_temp}°</p>\n                <p class="datetime">${t.datetime}</p>\n            </div>\n            `;for(const t of e.hotels)document.getElementById("hotelSelect").innerHTML+=`<option value="${t.hotelName}">${t.hotelName}</option>`;return $("#modalBody").slideDown(500),e},p=()=>{let e=localStorage.getItem("trips")?JSON.parse(localStorage.getItem("trips")):[],t={id:"",departure:"",return:"",city:{},currentWeather:{},forecastWeather:{},chosenHotel:{},image:""};t={id:1,departure:$("#departure").html(),return:$("#return").html(),city:s.city,currentWeather:s.currentWeather,forecastWeather:s.forecastWeather},null!=JSON.parse(localStorage.getItem("trips"))&&(t.id=JSON.parse(localStorage.getItem("trips")).length+1),null!=document.getElementById("hotelName")&&(t.chosenHotel={name:document.getElementById("hotelName").innerHTML,bookingURL:document.getElementById("hotelName").getAttribute("href")}),0!==s.images.length&&(t.image=s.images[0].webformatURL),e.push(t),localStorage.setItem("trips",JSON.stringify(e));let n=t.chosenHotel?t.chosenHotel.bookingURL:"#",r=t.chosenHotel?t.chosenHotel.name:"",i=t.image?`<img class="" src="${t.image}" alt="${t.city.name}"/>`:"";const a=document.createElement("div");a.classList.add("card-destination");let o=`\n        <button class="delete close" onclick="Client.remove(this)" value="${trip.id}" title="delete trip" data-toggle="tooltip" data-placement="left" aria-hidden="true">×</button> \n        <div class="destination-image">\n            ${i}\n        </div>\n        <div class="country-flag">\n            <span class="flag-icon flag-icon-${t.city.countryCode.toLowerCase()} flag-icon-squared country-flag-size-2x country-flag-circle"></span>\n        </div>\n        <div class="destination-info">\n            <div class="place-name">\n                <h2>${t.city.name} <small>${t.city.countryName}</small></h2>\n            </div>\n            <div class="place-desc">\n                <div class="current">\n                    <h6>Current<br>Weather</h6>\n                    <div>\n                        <p id="temp">${t.currentWeather.temp} °C</p>\n                        <p id="weather-description">${t.currentWeather.weather.description}</p>\n                    </div>\n                    <div>\n                        <img id="weather-icon" src="https://www.weatherbit.io/static/img/icons/${t.currentWeather.weather.icon}.png" width="70px"/>\n                    </div>\n                </div>\n            </div>\n            <div class="below-line"></div>\n            <div class="destination-hastag">\n                <div class="col-auto">\n                    <div class="input-group mb-2">\n                        <div class="input-group-prepend">\n                            <div class="input-group-text">from</div>\n                        </div>\n                        <p class="form-control" id="travelDate">${t.departure}</p>\n                        <div class="input-group-prepend">\n                            <div class="input-group-text">to</div>\n                        </div>\n                        <p class="form-control" id="travelDate">${t.return}</p>\n                    </div>\n                </div>\n                <div class="col-auto">\n                    <div class="input-group mb-2">\n                        <div class="input-group-prepend">\n                            <div class="input-group-text">Hotel</div>\n                        </div>\n                        <a class="form-control" id="travelDate" href="${n}">${r}</a>\n                    </div>\n                </div>\n            </div>\n        </div>            \n    `;a.innerHTML=o,document.getElementById("trips").appendChild(a),document.getElementById("clear").style.display="block",$("#cityModal").modal("hide")},g=()=>{localStorage.clear(),c()};function h(e){let t=JSON.parse(localStorage.getItem("trips"));t.splice(t.indexOf($(e).val()),1),$(e).parent().remove(),localStorage.setItem("trips",JSON.stringify(t)),e.parentElement.remove(),e.parentElement.remove(),0===JSON.parse(localStorage.getItem("trips")).length&&(document.getElementById("clear").style.display="none")}n.d(t,"remove",(function(){return h})),n.d(t,"cityAutocomplete",(function(){return r.a})),n.d(t,"handleSubmit",(function(){return d})),n.d(t,"selectHotel",(function(){return u})),n.d(t,"saveTrip",(function(){return p})),n.d(t,"clear",(function(){return g})),console.log(JSON.parse(localStorage.getItem("trips"))),c(),$((function(){$('[data-toggle="tooltip"]').tooltip()}))}]);
